select version();
             version              
----------------------------------
 Vertica Analytic Database v5.0.4
(1 row)

--create table company (id int, supervisor_id int, name varchar(20));
insert into company values (1, null, 'Patrick');
 OUTPUT 
--------
      1
(1 row)

insert into company values (2, 1, 'Jim');
 OUTPUT 
--------
      1
(1 row)

insert into company values (3, 1, 'Sandy');
 OUTPUT 
--------
      1
(1 row)

insert into company values (4, 3, 'Brian');
 OUTPUT 
--------
      1
(1 row)

insert into company values (4, 3, 'Otto');
 OUTPUT 
--------
      1
(1 row)

commit;
--Test connect_by_path()
select connect_by_path(supervisor_id, id, name, ' >> ') over () from company;
 identifier | depth |           path           
------------+-------+--------------------------
          1 |     0 | Patrick
          2 |     1 | Patrick >> Jim
          3 |     1 | Patrick >> Sandy
          4 |     2 | Patrick >> Sandy >> Otto
(4 rows)

