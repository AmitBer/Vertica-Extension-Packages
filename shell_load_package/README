-------------------------------
INTRODUCTION
-------------------------------

The Shell Load extension package provides a mechanism to execute shell
commands from within Vertica and retrieve the result as a stream of
raw file data to be loaded via the COPY command.  You can execute shell
commands to generate or fetch data, and commands to filter data loaded
by an existing Vertica source, passing it via pipes through an external
command.

Be aware: executing arbitrary shell commands (as the same user as the
Vertica process!) is a loaded gun and should be used with care.

-------------------------------
BUILDING
-------------------------------

To build:

$ make

To test the resulting binary:

$ make test

-------------------------------
INSTALLING / UNINSTALLING
-------------------------------

Assuming vsql is in your path, just do:

$ make install
$ make uninstall

-------------------------------
USAGE
-------------------------------

COPY <table> WITH SOURCE ExternalSource(cmd='<command>' [, nodes='<nodes list>']);
COPY <table> WITH FILTER ExternalFilter(cmd='<command>');

Arguments:
command    - command to execute.
nodes list - comma-separated list of node names to execute on,
             'ANY NODE' (default) or 'ALL NODES'.

The actual execution is accomplished by forking and running: sh -c <command>
Because the command is actually interpreted by the shell, pipes,
redirects, looping and other shell functionality is available.

Example:
create table t (i int);
copy t with source ExternalSource(cmd='seq 1 10');
copy t from 'list_of_numbers.txt.gz' with filter ExternalFilter(cmd='gunzip');

The following environment variables are available from ExternalSource:

  - CURRENT_NODE_NAME  - name of the current node, e.g. 'v_test_node0001'
  - TARGET_NODE_NAMES  - comma-separated list of nodes on which the query runs
  - NUM_SPLITS         - number of nodes on which the query runs
  - SPLIT_INDEX        - an index (0..NUM_SPLITS-1) of this node

You may use NUM_SPLITS and SPLIT_INDEX to have cmd return a subsed of data
on each node, e.g. that where [ $something % $NUM_SPLITS -eq $SPLIT_INDEX ].

The following environment variables are available from ExternalFilter:

  - CURRENT_NODE_NAME  - see above

-------------------------------
LICENSE
-------------------------------

Please see LICENSE.txt









ExternalSource

This UDL executes an external program and passes its stdout directly to Vertica.  It's effective, for example, if your data is generated by a program, or if your data is available on a remote computer and a command-line client program can access it.

To install this UDL, run "make install", or see the vsql commands under the 'install' target in the Makefile.

The ExternalSource UDL takes two arguments:
- 'cmd' (required): The command to execute.  Must be installed on all nodes that will execute the query; by far the simplest approach is to simply install it on all nodes.
- 'nodes' (optional): A comma-separated list of the names of nodes to run the query on.  If none is specified, chooses one node at random.

Usage example:

create table t (i int);
copy t with source ExternalSource(cmd='seq 1 10');

